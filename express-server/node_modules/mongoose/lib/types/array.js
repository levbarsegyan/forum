'use strict';
const CoreMongooseArray = require('./core_array');
const Document = require('../document');
const arrayAtomicsSymbol = require('../helpers/symbols').arrayAtomicsSymbol;
const arrayParentSymbol = require('../helpers/symbols').arrayParentSymbol;
const arrayPathSymbol = require('../helpers/symbols').arrayPathSymbol;
const arraySchemaSymbol = require('../helpers/symbols').arraySchemaSymbol;
const _basePush = Array.prototype.push;
function MongooseArray(values, path, doc) {
  const arr = new CoreMongooseArray();
  arr[arrayAtomicsSymbol] = {};
  if (Array.isArray(values)) {
    const len = values.length;
    for (let i = 0; i < len; ++i) {
      _basePush.call(arr, values[i]);
    }
    arr[arrayAtomicsSymbol] = values[arrayAtomicsSymbol] || {};
  }
  arr[arrayPathSymbol] = path;
  arr[arraySchemaSymbol] = void 0;
  if (doc && doc instanceof Document) {
    arr[arrayParentSymbol] = doc;
    arr[arraySchemaSymbol] = doc.schema.path(path);
  }
  return arr;
}
module.exports = exports = MongooseArray;
